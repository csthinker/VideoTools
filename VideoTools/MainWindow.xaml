<Window x:Class="VideoTools.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:VideoTools"
        mc:Ignorable="d"
        Title="视频工具箱" Height="580" Width="800"
        ResizeMode="CanMinimize"
        WindowStyle="SingleBorderWindow"
        SizeToContent="WidthAndHeight"
        Loaded="Window_Loaded"
        AllowDrop="True" Drop="Window_Drop" WindowStartupLocation="CenterScreen">
    <Window.Resources>
        <!-- 添加通用按钮样式 -->
        <Style x:Key="ModernButtonStyle" TargetType="{x:Type Button}">
            <Setter Property="Background" Value="#2196F3"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Padding" Value="15,8"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Button}">
                        <Border Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            CornerRadius="6">
                            <ContentPresenter HorizontalAlignment="Center" 
                                        VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#1976D2"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#1565C0"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Background" Value="#BDBDBD"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <!-- 添加次要按钮样式 -->
        <Style x:Key="ModernSecondaryButtonStyle" TargetType="{x:Type Button}">
            <Setter Property="Background" Value="#F5F5F5"/>
            <Setter Property="Foreground" Value="#424242"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Padding" Value="15,8"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="#E0E0E0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Button}">
                        <Border Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            CornerRadius="6">
                            <ContentPresenter HorizontalAlignment="Center" 
                                        VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#EEEEEE"/>
                                <Setter Property="BorderBrush" Value="#BDBDBD"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#E0E0E0"/>
                                <Setter Property="BorderBrush" Value="#9E9E9E"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Background" Value="#F5F5F5"/>
                                <Setter Property="BorderBrush" Value="#EEEEEE"/>
                                <Setter Property="Foreground" Value="#BDBDBD"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <!-- 添加取消按钮样式 -->
        <Style x:Key="ModernDangerButtonStyle" TargetType="{x:Type Button}">
            <Setter Property="Background" Value="#F44336"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Padding" Value="15,8"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Button}">
                        <Border Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            CornerRadius="12">
                            <ContentPresenter HorizontalAlignment="Center" 
                                        VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#E53935"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#D32F2F"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Background" Value="#FFCDD2"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <!-- 侧边栏Radiobtn样式 -->
        <Style x:Key="RadioButtonStyle" TargetType="{x:Type RadioButton}">
            <Setter Property="FocusVisualStyle">
                <Setter.Value>
                    <Style>
                        <Setter Property="Control.Template">
                            <Setter.Value>
                                <ControlTemplate>
                                    <Rectangle Margin="2" SnapsToDevicePixels="True" Stroke="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" StrokeThickness="1" StrokeDashArray="1 2"/>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Style>
                </Setter.Value>
            </Setter>
            <Setter Property="Margin" Value="0 2 0 0"/>
            <Setter Property="FontSize" Value="26"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="HorizontalContentAlignment" Value="Left"/>
            <Setter Property="BorderBrush" Value="Transparent"/>
            <Setter Property="Foreground" Value="Black"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type RadioButton}">
                        <Grid x:Name="templateRoot" Background="Transparent" SnapsToDevicePixels="True">
                            <Border x:Name="border" BorderBrush="Red" BorderThickness="0"  SnapsToDevicePixels="True"/>
                            <Border x:Name="bd2"/>
                            <ContentPresenter x:Name="contentPresenter" ContentTemplate="{TemplateBinding ContentTemplate}"
                                              Content="{TemplateBinding Content}" Grid.Column="1" 
                                              ContentStringFormat="{TemplateBinding ContentStringFormat}" Focusable="False" 
                                              HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" 
                                              Margin="{TemplateBinding Padding}" RecognizesAccessKey="True" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" 
                                              VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="HasContent" Value="True">
                                <Setter Property="FocusVisualStyle">
                                    <Setter.Value>
                                        <Style>
                                            <Setter Property="Control.Template">
                                                <Setter.Value>
                                                    <ControlTemplate>
                                                        <Rectangle Margin="14,0,0,0" SnapsToDevicePixels="True" Stroke="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" StrokeThickness="1" StrokeDashArray="1 2"/>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                        </Style>
                                    </Setter.Value>
                                </Setter>
                                <Setter Property="Padding" Value="4,-1,0,0"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#F7F7F7" TargetName="border"/>
                            </Trigger>
                            <Trigger Property="IsChecked" Value="true">
                                <Setter Property="Foreground"  Value="#2196F3"/>
                                <Setter Property="BorderThickness" Value="4 0 0 0" TargetName="bd2"/>
                                <Setter Property="BorderBrush" Value="#2196F3" TargetName="bd2"/>
                                <Setter Property="Background" Value="#2196F3" TargetName="border"/>
                                <Setter Property="Opacity" Value="0.05" TargetName="border"/>
                            </Trigger>
                            <Trigger Property="IsChecked" Value="{x:Null}"/>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Setter Property="MinHeight" Value="44"/>
            <Setter Property="HorizontalAlignment" Value="Stretch"/>
        </Style>
        <!-- 添加现代化Slider样式 -->
        <Style x:Key="ModernSliderStyle" TargetType="{x:Type Slider}">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Slider}">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto" MinHeight="{TemplateBinding MinHeight}"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Track x:Name="PART_Track" Grid.Row="1">
                                <Track.DecreaseRepeatButton>
                                    <RepeatButton Command="{x:Static Slider.DecreaseLarge}">
                                        <RepeatButton.Style>
                                            <Style TargetType="{x:Type RepeatButton}">
                                                <Setter Property="SnapsToDevicePixels" Value="True"/>
                                                <Setter Property="OverridesDefaultStyle" Value="True"/>
                                                <Setter Property="Template">
                                                    <Setter.Value>
                                                        <ControlTemplate TargetType="{x:Type RepeatButton}">
                                                            <Border Height="4" CornerRadius="2" 
                                                                Background="#2196F3"/>
                                                        </ControlTemplate>
                                                    </Setter.Value>
                                                </Setter>
                                            </Style>
                                        </RepeatButton.Style>
                                    </RepeatButton>
                                </Track.DecreaseRepeatButton>
                                <Track.IncreaseRepeatButton>
                                    <RepeatButton Command="{x:Static Slider.IncreaseLarge}">
                                        <RepeatButton.Style>
                                            <Style TargetType="{x:Type RepeatButton}">
                                                <Setter Property="SnapsToDevicePixels" Value="True"/>
                                                <Setter Property="OverridesDefaultStyle" Value="True"/>
                                                <Setter Property="Template">
                                                    <Setter.Value>
                                                        <ControlTemplate TargetType="{x:Type RepeatButton}">
                                                            <Border Height="4" CornerRadius="2"
                                                                Background="#E0E0E0"/>
                                                        </ControlTemplate>
                                                    </Setter.Value>
                                                </Setter>
                                            </Style>
                                        </RepeatButton.Style>
                                    </RepeatButton>
                                </Track.IncreaseRepeatButton>
                                <Track.Thumb>
                                    <Thumb>
                                        <Thumb.Style>
                                            <Style TargetType="{x:Type Thumb}">
                                                <Setter Property="SnapsToDevicePixels" Value="True"/>
                                                <Setter Property="OverridesDefaultStyle" Value="True"/>
                                                <Setter Property="Template">
                                                    <Setter.Value>
                                                        <ControlTemplate TargetType="{x:Type Thumb}">
                                                            <Grid>
                                                                <Ellipse Width="16" Height="16" Fill="White">
                                                                    <Ellipse.Effect>
                                                                        <DropShadowEffect BlurRadius="4" ShadowDepth="1" 
                                                                                    Opacity="0.25"/>
                                                                    </Ellipse.Effect>
                                                                </Ellipse>
                                                                <Ellipse Width="16" Height="16" 
                                                                     Stroke="#2196F3" StrokeThickness="2"/>
                                                            </Grid>
                                                        </ControlTemplate>
                                                    </Setter.Value>
                                                </Setter>
                                            </Style>
                                        </Thumb.Style>
                                    </Thumb>
                                </Track.Thumb>
                            </Track>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Opacity" Value="0.5"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <!-- 添加时间输入框样式 -->
        <Style x:Key="TimeSpinnerStyle" TargetType="Grid">
            <Setter Property="Height" Value="30"/>
            <Setter Property="Width" Value="167"/>
        </Style>
        <!-- 上箭头btn样式 -->
        <Style x:Key="SpinButtonStyleUp" TargetType="RepeatButton">
            <Setter Property="Width" Value="20"/>
            <Setter Property="Height" Value="15"/>
            <Setter Property="Background" Value="#F5F5F5"/>
            <Setter Property="BorderBrush" Value="#E0E0E0"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="RepeatButton">
                        <Border Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}">
                            <Path x:Name="Arrow" 
                              Data="M 0 4 L 8 4 L 4 0 Z" 
                              Fill="#424242"
                              Width="8"
                              Height="4"
                              Stretch="Fill"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#EEEEEE"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#E0E0E0"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <!-- 下箭头btn样式 -->
        <Style x:Key="SpinButtonStyleDown" TargetType="RepeatButton">
            <Setter Property="Width" Value="20"/>
            <Setter Property="Height" Value="15"/>
            <Setter Property="Background" Value="#F5F5F5"/>
            <Setter Property="BorderBrush" Value="#E0E0E0"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="RepeatButton">
                        <Border Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}">
                            <Path x:Name="Arrow" 
                                Data="M 0 0 L 8 0 L 4 4 Z"  
                                Fill="#424242"
                                Width="8"
                                Height="4"
                                Stretch="Fill"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#EEEEEE"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#E0E0E0"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <!-- 添加现代化进度条样式 -->
        <Style x:Key="ModernProgressBarStyle" TargetType="{x:Type ProgressBar}">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ProgressBar}">
                        <Grid x:Name="TemplateRoot">
                            <Border Background="#F5F5F5" 
                            BorderBrush="{x:Null}" 
                            BorderThickness="0" 
                            CornerRadius="4"/>
                            <Border x:Name="PART_Track" 
                            Background="#F5F5F5" 
                            BorderBrush="{x:Null}" 
                            BorderThickness="0" 
                            CornerRadius="4"/>
                            <Border x:Name="PART_Indicator" 
                            Background="#2196F3" 
                            BorderBrush="{x:Null}" 
                            BorderThickness="0" 
                            CornerRadius="4" 
                            HorizontalAlignment="Left">
                                <Border.Effect>
                                    <DropShadowEffect BlurRadius="4" 
                                            ShadowDepth="1" 
                                            Color="#2196F3" 
                                            Opacity="0.3"/>
                                </Border.Effect>
                            </Border>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsIndeterminate" Value="True">
                                <Setter Property="Background" TargetName="PART_Indicator" Value="#2196F3"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <!-- 添加Radiobutton样式 -->
        <Style x:Key="ButtonRadioStyle" TargetType="RadioButton">
            <Setter Property="Background" Value="#F5F7FA"/>
            <Setter Property="Foreground" Value="#212121"/>
            <Setter Property="Padding" Value="16"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Margin" Value="0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="RadioButton">
                        <Border 
                            Background="{TemplateBinding Background}"
                            BorderBrush="#DADCE0"
                            BorderThickness="1"
                            CornerRadius="4">
                            <Grid>
                                <TextBlock 
                                    Text="{TemplateBinding Content}"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"/>
                            </Grid>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter Property="Background" Value="#99cbf3"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#bbdaf3"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <!-- 侧边栏按钮样式 -->
        <Style x:Key="MenuButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="#666666"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Height" Value="40"/>
            <Setter Property="Width" Value="40"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            CornerRadius="20">
                            <ContentPresenter HorizontalAlignment="Center" 
                                        VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#E0E0E0"/>
                    <Setter Property="Foreground" Value="#333333"/>
                </Trigger>
                <Trigger Property="IsPressed" Value="True">
                    <Setter Property="Background" Value="#CCCCCC"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        <!-- 添加双端进度条样式（基础版，保留） -->
        <Style x:Key="ModernRangeSliderStyle" TargetType="{x:Type Slider}">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Slider}">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto" MinHeight="{TemplateBinding MinHeight}"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Track x:Name="PART_Track" Grid.Row="1">
                                <Track.DecreaseRepeatButton>
                                    <RepeatButton Command="{x:Static Slider.DecreaseLarge}">
                                        <RepeatButton.Style>
                                            <Style TargetType="{x:Type RepeatButton}">
                                                <Setter Property="SnapsToDevicePixels" Value="True"/>
                                                <Setter Property="OverridesDefaultStyle" Value="True"/>
                                                <Setter Property="Template">
                                                    <Setter.Value>
                                                        <ControlTemplate TargetType="{x:Type RepeatButton}">
                                                            <Border Height="4" CornerRadius="2" 
                                                                Background="#2196F3"/>
                                                        </ControlTemplate>
                                                    </Setter.Value>
                                                </Setter>
                                            </Style>
                                        </RepeatButton.Style>
                                    </RepeatButton>
                                </Track.DecreaseRepeatButton>
                                <Track.IncreaseRepeatButton>
                                    <RepeatButton Command="{x:Static Slider.IncreaseLarge}">
                                        <RepeatButton.Style>
                                            <Style TargetType="{x:Type RepeatButton}">
                                                <Setter Property="SnapsToDevicePixels" Value="True"/>
                                                <Setter Property="OverridesDefaultStyle" Value="True"/>
                                                <Setter Property="Template">
                                                    <Setter.Value>
                                                        <ControlTemplate TargetType="{x:Type RepeatButton}">
                                                            <Border Height="4" CornerRadius="2"
                                                                Background="#E0E0E0"/>
                                                        </ControlTemplate>
                                                    </Setter.Value>
                                                </Setter>
                                            </Style>
                                        </RepeatButton.Style>
                                    </RepeatButton>
                                </Track.IncreaseRepeatButton>
                                <Track.Thumb>
                                    <Thumb>
                                        <Thumb.Style>
                                            <Style TargetType="{x:Type Thumb}">
                                                <Setter Property="SnapsToDevicePixels" Value="True"/>
                                                <Setter Property="OverridesDefaultStyle" Value="True"/>
                                                <Setter Property="Template">
                                                    <Setter.Value>
                                                        <ControlTemplate TargetType="{x:Type Thumb}">
                                                            <Grid>
                                                                <Ellipse Width="16" Height="16" Fill="White">
                                                                    <Ellipse.Effect>
                                                                        <DropShadowEffect BlurRadius="4" ShadowDepth="1" 
                                                                                    Opacity="0.25"/>
                                                                    </Ellipse.Effect>
                                                                </Ellipse>
                                                                <Ellipse Width="16" Height="16" 
                                                                     Stroke="#2196F3" StrokeThickness="2"/>
                                                            </Grid>
                                                        </ControlTemplate>
                                                    </Setter.Value>
                                                </Setter>
                                            </Style>
                                        </Thumb.Style>
                                    </Thumb>
                                </Track.Thumb>
                            </Track>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- 双端进度条：起点滑块样式（左侧灰、右侧蓝） -->
        <Style x:Key="ModernRangeStartSliderStyle" TargetType="{x:Type Slider}">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Slider}">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto" MinHeight="{TemplateBinding MinHeight}"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Track x:Name="PART_Track" Grid.Row="1">
                                <!-- 左侧（Decrease）灰色 -->
                                <Track.DecreaseRepeatButton>
                                    <RepeatButton Command="{x:Static Slider.DecreaseLarge}">
                                        <RepeatButton.Style>
                                            <Style TargetType="{x:Type RepeatButton}">
                                                <Setter Property="SnapsToDevicePixels" Value="True"/>
                                                <Setter Property="OverridesDefaultStyle" Value="True"/>
                                                <Setter Property="Template">
                                                    <Setter.Value>
                                                        <ControlTemplate TargetType="{x:Type RepeatButton}">
                                                            <Border Height="4" CornerRadius="2" Background="#E0E0E0"/>
                                                        </ControlTemplate>
                                                    </Setter.Value>
                                                </Setter>
                                            </Style>
                                        </RepeatButton.Style>
                                    </RepeatButton>
                                </Track.DecreaseRepeatButton>
                                <!-- 右侧（Increase）蓝色 -->
                                <Track.IncreaseRepeatButton>
                                    <RepeatButton Command="{x:Static Slider.IncreaseLarge}">
                                        <RepeatButton.Style>
                                            <Style TargetType="{x:Type RepeatButton}">
                                                <Setter Property="SnapsToDevicePixels" Value="True"/>
                                                <Setter Property="OverridesDefaultStyle" Value="True"/>
                                                <Setter Property="Template">
                                                    <Setter.Value>
                                                        <ControlTemplate TargetType="{x:Type RepeatButton}">
                                                            <Border Height="4" CornerRadius="2" Background="#2196F3"/>
                                                        </ControlTemplate>
                                                    </Setter.Value>
                                                </Setter>
                                            </Style>
                                        </RepeatButton.Style>
                                    </RepeatButton>
                                </Track.IncreaseRepeatButton>
                                <Track.Thumb>
                                    <Thumb>
                                        <Thumb.Style>
                                            <Style TargetType="{x:Type Thumb}">
                                                <Setter Property="SnapsToDevicePixels" Value="True"/>
                                                <Setter Property="OverridesDefaultStyle" Value="True"/>
                                                <Setter Property="Template">
                                                    <Setter.Value>
                                                        <ControlTemplate TargetType="{x:Type Thumb}">
                                                            <Grid>
                                                                <Ellipse Width="16" Height="16" Fill="White">
                                                                    <Ellipse.Effect>
                                                                        <DropShadowEffect BlurRadius="4" ShadowDepth="1" Opacity="0.25"/>
                                                                    </Ellipse.Effect>
                                                                </Ellipse>
                                                                <Ellipse Width="16" Height="16" Stroke="#2196F3" StrokeThickness="2"/>
                                                            </Grid>
                                                        </ControlTemplate>
                                                    </Setter.Value>
                                                </Setter>
                                            </Style>
                                        </Thumb.Style>
                                    </Thumb>
                                </Track.Thumb>
                            </Track>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- 双端进度条：终点滑块样式（左侧透明、右侧灰） -->
        <Style x:Key="ModernRangeEndSliderStyle" TargetType="{x:Type Slider}">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Slider}">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto" MinHeight="{TemplateBinding MinHeight}"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Track x:Name="PART_Track" Grid.Row="1">
                                <!-- 左侧（Decrease）透明，让起点滑块的蓝色区间透出 -->
                                <Track.DecreaseRepeatButton>
                                    <RepeatButton Command="{x:Static Slider.DecreaseLarge}">
                                        <RepeatButton.Style>
                                            <Style TargetType="{x:Type RepeatButton}">
                                                <!-- 关键：禁用命中测试，避免覆盖下层起点滑块的拇指点击 -->
                                                <Setter Property="IsHitTestVisible" Value="False"/>
                                                <Setter Property="SnapsToDevicePixels" Value="True"/>
                                                <Setter Property="OverridesDefaultStyle" Value="True"/>
                                                <Setter Property="Template">
                                                    <Setter.Value>
                                                        <ControlTemplate TargetType="{x:Type RepeatButton}">
                                                            <Border Height="4" CornerRadius="2" Background="Transparent"/>
                                                        </ControlTemplate>
                                                    </Setter.Value>
                                                </Setter>
                                            </Style>
                                        </RepeatButton.Style>
                                    </RepeatButton>
                                </Track.DecreaseRepeatButton>
                                <!-- 右侧（Increase）灰色，用来遮住超出终点的蓝色部分 -->
                                <Track.IncreaseRepeatButton>
                                    <RepeatButton Command="{x:Static Slider.IncreaseLarge}">
                                        <RepeatButton.Style>
                                            <Style TargetType="{x:Type RepeatButton}">
                                                <Setter Property="SnapsToDevicePixels" Value="True"/>
                                                <Setter Property="OverridesDefaultStyle" Value="True"/>
                                                <Setter Property="Template">
                                                    <Setter.Value>
                                                        <ControlTemplate TargetType="{x:Type RepeatButton}">
                                                            <Border Height="4" CornerRadius="2" Background="#E0E0E0"/>
                                                        </ControlTemplate>
                                                    </Setter.Value>
                                                </Setter>
                                            </Style>
                                        </RepeatButton.Style>
                                    </RepeatButton>
                                </Track.IncreaseRepeatButton>
                                <Track.Thumb>
                                    <Thumb>
                                        <Thumb.Style>
                                            <Style TargetType="{x:Type Thumb}">
                                                <Setter Property="SnapsToDevicePixels" Value="True"/>
                                                <Setter Property="OverridesDefaultStyle" Value="True"/>
                                                <Setter Property="Template">
                                                    <Setter.Value>
                                                        <ControlTemplate TargetType="{x:Type Thumb}">
                                                            <Grid>
                                                                <Ellipse Width="16" Height="16" Fill="White">
                                                                    <Ellipse.Effect>
                                                                        <DropShadowEffect BlurRadius="4" ShadowDepth="1" Opacity="0.25"/>
                                                                    </Ellipse.Effect>
                                                                </Ellipse>
                                                                <Ellipse Width="16" Height="16" Stroke="#2196F3" StrokeThickness="2"/>
                                                            </Grid>
                                                        </ControlTemplate>
                                                    </Setter.Value>
                                                </Setter>
                                            </Style>
                                        </Thumb.Style>
                                    </Thumb>
                                </Track.Thumb>
                            </Track>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="177"></ColumnDefinition>
            <ColumnDefinition Width="0*"></ColumnDefinition>
            <ColumnDefinition Width="0*"/>
            <ColumnDefinition/>
        </Grid.ColumnDefinitions>

        <!-- 侧边栏 -->
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            <StackPanel Grid.Row="0">
                <TextBlock Foreground="#8F8F8F" FontSize="13" Margin="15 15 0 20"/>
                <UniformGrid Columns="2">
                    <StackPanel Orientation="Horizontal" Margin="0,0,-89,0">
                        <TextBlock Text="&#xe6dd;" FontFamily="./assets/fonts/#iconfont" FontSize="26"  Margin="10 0 0 0" Height="30"/>
                        <TextBlock FontSize="18" 
                                   VerticalAlignment="Center" Margin="5,0,0,0" 
                                   RenderTransformOrigin="0.214,0.333" 
                                   Width="120" Height="27" 
                                   Text="视频处理" 
                                   HorizontalAlignment="Left" 
                                   TextOptions.TextHintingMode="Fixed"
                                   FontWeight="Bold"/>
                    </StackPanel>
                </UniformGrid>
                <RadioButton x:Name="radiobtn_compress"  Tag="compress" 
                             Style="{DynamicResource RadioButtonStyle}" 
                             Click="RadioBtn_Compress_Click">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="&#xe607;" FontFamily="./assets/fonts/#iconfont" FontSize="22" 
                                   Margin="10 0 0 0" Foreground="#2196F3"/>
                        <TextBlock Margin="10 0 0 0" Text="视频压缩"  FontSize="14" VerticalAlignment="Center" 
                                   Foreground="{Binding Foreground, RelativeSource={
                                            RelativeSource FindAncestor,
                                            AncestorLevel=1,
                                            AncestorType={x:Type RadioButton}
                                        }
                                    }" />
                    </StackPanel>
                </RadioButton>

                <RadioButton Tag="cut" 
                     Style="{DynamicResource RadioButtonStyle}" 
                     Click="RadioBtn_Compress_Click">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="&#xe948;" FontFamily="./assets/fonts/#iconfont" FontSize="22" 
                           Margin="10 0 0 0" Foreground="#1E1E1E"/>
                        <TextBlock Margin="10 0 0 0" Text="视频裁剪"  FontSize="14" VerticalAlignment="Center" 
                           Foreground="{Binding Foreground, RelativeSource={
                                    RelativeSource FindAncestor,
                                    AncestorLevel=1,
                                    AncestorType={x:Type RadioButton}
                                }
                            }" />
                    </StackPanel>
                </RadioButton>

                <RadioButton Tag="convert" 
                             Style="{DynamicResource RadioButtonStyle}" Click="RadioBtn_Compress_Click">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="&#xe6d1;" FontFamily="./assets/fonts/#iconfont" FontSize="22" 
                                   Margin="10 0 0 0" Foreground="#CD3700"/>
                        <TextBlock  Margin="10 0 0 0" Text="格式转换"  FontSize="14" VerticalAlignment="Center"
                                   Foreground="{Binding Foreground, RelativeSource={
                                            RelativeSource FindAncestor, 
                                            AncestorLevel=1, 
                                            AncestorType={x:Type RadioButton}
                                        }
                                    }" />
                    </StackPanel>
                </RadioButton>

                <RadioButton Tag="gif"
                             Style="{DynamicResource RadioButtonStyle}" Click="RadioBtn_Compress_Click">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="&#xe686;" FontFamily="./assets/fonts/#iconfont" FontSize="22" 
                                   Margin="10 0 0 0" Foreground="Green"/>
                        <TextBlock  Margin="10 0 0 0" Text="转GIF"  FontSize="14" VerticalAlignment="Center"
                                   Foreground="{Binding Foreground, RelativeSource={
                                    RelativeSource FindAncestor, AncestorLevel=1, AncestorType={x:Type RadioButton}}}" />
                    </StackPanel>
                </RadioButton>

                <RadioButton Tag="multiple" 
                             Style="{DynamicResource RadioButtonStyle}" Click="RadioBtn_Compress_Click">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="&#xf0de;" FontFamily="./assets/fonts/#iconfont" FontSize="22" 
                                   Margin="10 0 0 0" Foreground="#E59151"/>
                        <TextBlock  Margin="10 0 0 0" Text="视频加速"  FontSize="14" VerticalAlignment="Center"
                                   Foreground="{Binding Foreground, RelativeSource={
                                    RelativeSource FindAncestor, AncestorLevel=1, AncestorType={x:Type RadioButton}}}" />
                    </StackPanel>
                </RadioButton>

                <RadioButton Tag="resize" 
                             Style="{DynamicResource RadioButtonStyle}" Click="RadioBtn_Compress_Click">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="&#xe600;" FontFamily="./assets/fonts/#iconfont" FontSize="22" 
                                   Margin="10 0 0 0" Foreground="#FF5F5F" />
                        <TextBlock  Margin="10 0 0 0" Text="修改尺寸"  FontSize="14" VerticalAlignment="Center"
                                   Foreground="{Binding Foreground, RelativeSource={
                                    RelativeSource FindAncestor, AncestorLevel=1, AncestorType={x:Type RadioButton}}}" />
                    </StackPanel>
                </RadioButton>

                <RadioButton Tag="voice" 
                             Style="{DynamicResource RadioButtonStyle}" Click="RadioBtn_Compress_Click">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="&#xe67f;" FontFamily="./assets/fonts/#iconfont" FontSize="22" 
                                   Margin="10 0 0 0" Foreground="#A57BD7" />
                        <TextBlock  Margin="10 0 0 0" Text="音频处理"  FontSize="14" VerticalAlignment="Center"
                                   Foreground="{Binding Foreground, RelativeSource={
                                    RelativeSource FindAncestor, AncestorLevel=1, AncestorType={x:Type RadioButton}}}" />
                    </StackPanel>
                </RadioButton>

                <RadioButton x:Name="radiobtn_setting" Tag="setting" 
                             Style="{DynamicResource RadioButtonStyle}" Click="RadioBtn_Compress_Click" >
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="&#xea6b;" FontFamily="./assets/fonts/#iconfont" FontSize="22" 
                                   Margin="10 0 0 0" Foreground="#6074C2" />
                        <TextBlock  Margin="10 0 0 0" Text="设置"  FontSize="14" VerticalAlignment="Center"
                                   Foreground="{Binding Foreground, RelativeSource={
                                    RelativeSource FindAncestor, AncestorLevel=1, AncestorType={x:Type RadioButton}}}" />
                    </StackPanel>
                </RadioButton>
            </StackPanel>
            <!-- 固定在侧边栏底部的关于按钮 -->
            <Button x:Name="btnAbout"
                    Grid.Row="1"
                    Style="{StaticResource MenuButtonStyle}"
                    Click="BtnAbout_Click"
                    Width="25"
                    Height="25"
                    HorizontalAlignment="Left"
                    VerticalAlignment="Bottom"
                    Margin="15,0,0,15">
                <TextBlock Text="&#xE601;"
                           FontFamily="./assets/fonts/#iconfont"
                           FontSize="20"
                           VerticalAlignment="Center"
                           HorizontalAlignment="Center"/>
            </Button>
        </Grid>

        <!-- 视频下方配置窗口 -->
        <Grid Grid.Column="3" Background="#FAFAFA" Margin="0,0,2,0" Height="565" VerticalAlignment="Bottom">
            <!-- 视频压缩面板 -->
            <Grid x:Name="compressPanel" Visibility="Visible" Margin="0,300,0,0">
                <Label Content="视频编码" HorizontalAlignment="Left" Margin="22,26,0,0" VerticalAlignment="Top" RenderTransformOrigin="-0.538,0.56" Width="98" FontSize="16"/>
                <RadioButton Tag="radiobtn_compress_264" Content="H.264" HorizontalAlignment="Left" Margin="42,66,0,0" VerticalAlignment="Top" IsChecked="True" Click="RadioBtn_CompressChoose_Click" FontSize="16"/>
                <RadioButton Tag="radiobtn_compress_265" Content="H.265" HorizontalAlignment="Left" Margin="121,66,0,0" VerticalAlignment="Top" Click="RadioBtn_CompressChoose_Click" FontSize="16"/>
                <RadioButton Tag="radiobtn_compress_av1" Content="AV1" HorizontalAlignment="Left" Margin="199,66,0,0" VerticalAlignment="Top" Click="RadioBtn_CompressChoose_Click" FontSize="16"/>
                <Label Content="CRF值越高，视频质量损失越高，文件体积越小" HorizontalAlignment="Left" Margin="22,102,0,0" VerticalAlignment="Top" RenderTransformOrigin="-0.538,0.56" Width="417" FontSize="16"/>
                <Slider x:Name="sliderCompressCrf" Style="{StaticResource ModernSliderStyle}"
                        HorizontalAlignment="Left" Margin="28,145,0,0" VerticalAlignment="Top" Width="357" Maximum="50" Value="25"
                        ValueChanged="CompressSlider_ValueChanged"/>
                <Label Content="无损" HorizontalAlignment="Left" Margin="22,167,0,0" VerticalAlignment="Top"/>
                <Label Content="推荐" HorizontalAlignment="Left" Margin="190,167,0,0" VerticalAlignment="Top" RenderTransformOrigin="4.765,0.48"/>
                <Label Content="质量损失较高" HorizontalAlignment="Left" Margin="319,167,0,0" VerticalAlignment="Top" RenderTransformOrigin="4.765,0.48" Width="101"/>
                <Label x:Name="labelCompressCrf" Content="25" HorizontalAlignment="Left" Margin="390,139,0,0" VerticalAlignment="Top" RenderTransformOrigin="0.375,0.36" FontSize="16"/>
                <Button Content="开始处理" Style="{StaticResource ModernButtonStyle}" 
                        HorizontalAlignment="Left" Margin="485,195,0,0" VerticalAlignment="Top" Width="100" Height="36" 
                        RenderTransformOrigin="0.12,0.579" 
                        Click="BtnProcess_Click"/>
            </Grid>

            <!-- 视频裁剪面板 -->
            <Grid x:Name="cutPanel" Visibility="Collapsed" Margin="0,300,0,0">
                <!-- 这里放裁剪相关的UI控件 -->
                <!-- 添加区间选择进度条 -->
                <Grid Margin="22,120,74,0" Height="30" VerticalAlignment="Top">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="365.71"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <!-- 区间进度条 -->
                    <!-- 开始位置滑块 -->
                    <Slider x:Name="startPositionSlider" 
                            Style="{StaticResource ModernRangeStartSliderStyle}"
                            Minimum="0" Maximum="100" 
                            Value="0"
                            ValueChanged="StartPositionSlider_ValueChanged"
                            Margin="0,0,0,0"/>

                    <!-- 结束位置滑块 -->
                    <Slider x:Name="endPositionSlider" 
                            Style="{StaticResource ModernRangeEndSliderStyle}"
                            Panel.ZIndex="1"
                            Minimum="0" Maximum="100" 
                            Value="100"
                            ValueChanged="EndPositionSlider_ValueChanged"
                            Margin="17,0,0,0" Grid.ColumnSpan="2" HorizontalAlignment="Left" Width="498"/>
                </Grid>
                <Label Content="开始位置" HorizontalAlignment="Left" Margin="20,53,0,0" VerticalAlignment="Top" Width="84" FontSize="16"/>
                <Grid Style="{StaticResource TimeSpinnerStyle}" Margin="100,53,0,0" HorizontalAlignment="Left" VerticalAlignment="Top">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <TextBox x:Name="cut_start_time" 
                        Text="00:00:00" 
                        FontSize="14" 
                        VerticalContentAlignment="Center"
                        TextAlignment="Center"
                        PreviewTextInput="TimeTextBox_PreviewTextInput"
                        TextChanged="TimeTextBox_TextChanged"/>
                    <StackPanel Grid.Column="1" Width="20">
                        <RepeatButton Style="{StaticResource SpinButtonStyleUp}"
                                Click="TimeSpinButton_Up_Click"/>
                        <RepeatButton Style="{StaticResource SpinButtonStyleDown}"
                                Click="TimeSpinButton_Down_Click"/>
                    </StackPanel>
                </Grid>
                <Label Content="结束位置" HorizontalAlignment="Left" Margin="300,53,0,0" VerticalAlignment="Top" Width="84" FontSize="16"/>
                <Grid Style="{StaticResource TimeSpinnerStyle}" Margin="380,53,0,0" HorizontalAlignment="Left" VerticalAlignment="Top">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <TextBox x:Name="cut_end_time" 
                        Text="00:00:00" 
                        FontSize="14" 
                        VerticalContentAlignment="Center"
                        TextAlignment="Center"
                        PreviewTextInput="TimeTextBox_PreviewTextInput"
                        TextChanged="TimeTextBox_TextChanged"/>
                    <StackPanel Grid.Column="1" Width="20">
                        <RepeatButton Style="{StaticResource SpinButtonStyleUp}"
                            Click="TimeSpinButton_Up_Click"/>
                        <RepeatButton Style="{StaticResource SpinButtonStyleDown}"
                            Click="TimeSpinButton_Down_Click"/>
                    </StackPanel>
                </Grid>
                <Button Content="开始处理" Style="{StaticResource ModernButtonStyle}"
                    HorizontalAlignment="Left" Margin="485,195,0,0" VerticalAlignment="Top" Width="100" Height="36"
                    RenderTransformOrigin="0.12,0.579"
                    Click="BtnCut_Click"/>

            </Grid>

            <!-- 格式转换面板 -->
            <Grid x:Name="convertPanel" Visibility="Collapsed" Margin="0,300,0,0">
                <!-- 这里放格式转换相关的UI控件 -->
                <Label Content="目标格式" HorizontalAlignment="Left" Margin="22,48,0,0" VerticalAlignment="Top" RenderTransformOrigin="-0.538,0.56" Width="98" FontSize="16"/>
                <RadioButton Tag="mp4" Content="MP4" HorizontalAlignment="Left" Margin="40,91,0,0" VerticalAlignment="Top" Width="59" FontSize="16" IsChecked="True" Click="RadioBtn_ConvertChoose_Click"/>
                <RadioButton Tag="avi" Content="AVI" HorizontalAlignment="Left" Margin="110,91,0,0" VerticalAlignment="Top" RenderTransformOrigin="2.244,0.571" Width="50" FontSize="16" Click="RadioBtn_ConvertChoose_Click"/>
                <RadioButton Tag="mkv" Content="MKV" HorizontalAlignment="Left" Margin="173,91,0,0" VerticalAlignment="Top" RenderTransformOrigin="2.244,0.571" Width="55" FontSize="16" Click="RadioBtn_ConvertChoose_Click"/>
                <Button Content="开始转换" 
                        Style="{StaticResource ModernButtonStyle}" 
                        HorizontalAlignment="Left" Margin="485,195,0,0" VerticalAlignment="Top" 
                        Width="100" RenderTransformOrigin="0.12,0.579" Height="36"
                        Click="BtnProcess_Click"/>
            </Grid>

            <!-- GIF面板 -->
            <Grid x:Name="gifPanel" Visibility="Collapsed" Margin="0,300,0,0">
                <Label Content="每秒帧数(FPS)" HorizontalAlignment="Left" Margin="22,34,0,0" VerticalAlignment="Top" Width="127" FontSize="16"/>
                <Slider x:Name="sliderGifFps" Style="{StaticResource ModernSliderStyle}"
                        HorizontalAlignment="Left" Margin="27,73,0,0" VerticalAlignment="Top" Width="278" 
                        Minimum="5" Maximum="30" Value="10"
                        ValueChanged="GifSlider_ValueChanged"/>
                <TextBox x:Name="textBox_Gif_Fps" HorizontalAlignment="Left" Height="20" Margin="310,71,0,0" TextWrapping="Wrap" Text="10" VerticalAlignment="Top" Width="44" FontSize="14" TextAlignment="Center"/>
                <Label Content="GIF大小" HorizontalAlignment="Left" Margin="22,98,0,0" VerticalAlignment="Top" Width="73" FontSize="16"/>
                <TextBox x:Name="textBox_Gif_Width" HorizontalAlignment="Left" Height="20" Margin="128,103,0,0" TextWrapping="Wrap" Text="0" VerticalAlignment="Top" Width="68" FontSize="14" TextAlignment="Center"/>
                <TextBox x:Name="textBox_Gif_Height" HorizontalAlignment="Left" Height="20" Margin="222,103,0,0" TextWrapping="Wrap" Text="0" VerticalAlignment="Top" Width="67" FontSize="14" TextAlignment="Center"/>
                <Label Content="宽" HorizontalAlignment="Left" Margin="109,104,0,0" VerticalAlignment="Top" Width="24"/>
                <Label Content="高" HorizontalAlignment="Left" Margin="202,104,0,0" VerticalAlignment="Top" Width="24"/>
                <Label Content="开始位置" HorizontalAlignment="Left" Margin="22,139,0,0" VerticalAlignment="Top" Width="84" FontSize="16"/>
                <Grid Style="{StaticResource TimeSpinnerStyle}" Margin="122,142,0,0" HorizontalAlignment="Left" VerticalAlignment="Top">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <TextBox x:Name="txtStartTime" 
                            Text="00:00:00" 
                            FontSize="14" 
                            VerticalContentAlignment="Center"
                            TextAlignment="Center"
                            PreviewTextInput="TimeTextBox_PreviewTextInput"
                            TextChanged="TimeTextBox_TextChanged"/>
                    <StackPanel Grid.Column="1" Width="20">
                        <RepeatButton Style="{StaticResource SpinButtonStyleUp}"
                            Click="TimeSpinButton_Up_Click"/>
                        <RepeatButton Style="{StaticResource SpinButtonStyleDown}"
                            Click="TimeSpinButton_Down_Click"/>
                    </StackPanel>
                </Grid>

                <Label Content="结束位置" HorizontalAlignment="Left" Margin="22,170,0,0" VerticalAlignment="Top" Width="84" FontSize="16"/>
                <Grid Style="{StaticResource TimeSpinnerStyle}" Margin="122,175,0,0" HorizontalAlignment="Left" VerticalAlignment="Top">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <TextBox x:Name="txtEndTime" 
                        Text="00:00:00" 
                        FontSize="14" 
                        VerticalContentAlignment="Center"
                        TextAlignment="Center"
                        PreviewTextInput="TimeTextBox_PreviewTextInput"
                        TextChanged="TimeTextBox_TextChanged"/>
                    <StackPanel Grid.Column="1" Width="20">
                        <RepeatButton Style="{StaticResource SpinButtonStyleUp}"
                            Click="TimeSpinButton_Up_Click"/>
                        <RepeatButton Style="{StaticResource SpinButtonStyleDown}"
                            Click="TimeSpinButton_Down_Click"/>
                    </StackPanel>
                </Grid>
                <CheckBox x:Name="checkBox_Gif_Loop" Content="GIF循环播放" HorizontalAlignment="Left" Margin="374,73,0,0" VerticalAlignment="Top" Width="109" IsChecked="True" Height="18" FontSize="14"/>
                <Button Content="开始处理" Style="{StaticResource ModernButtonStyle}"
                        HorizontalAlignment="Left" Margin="485,195,0,0" VerticalAlignment="Top" Width="100" Height="36"
                        RenderTransformOrigin="0.12,0.579"
                        Click="BtnProcess_Click"/>
                <Button Tag="320" Style="{StaticResource ModernSecondaryButtonStyle}" 
                        Content="320P" HorizontalAlignment="Left" Margin="310,103,0,0" VerticalAlignment="Top" Width="40" 
                        Click="BtnGifResize_Click"/>
                <Button Tag="480" Style="{StaticResource ModernSecondaryButtonStyle}"
                        Content="480P" HorizontalAlignment="Left" Margin="355,103,0,0" VerticalAlignment="Top" Width="40"
                        Click="BtnGifResize_Click"/>
                <Button Tag="720" Style="{StaticResource ModernSecondaryButtonStyle}" 
                        Content="720P" HorizontalAlignment="Left" Margin="400,103,0,0" VerticalAlignment="Top" Width="40" 
                        Click="BtnGifResize_Click"/>
                <Button Tag="1080" Style="{StaticResource ModernSecondaryButtonStyle}" 
                        Content="1080P" HorizontalAlignment="Left" Margin="445,103,0,0" VerticalAlignment="Top" Width="50" 
                        Click="BtnGifResize_Click"/>
                <Button Tag="Orig" Style="{StaticResource ModernSecondaryButtonStyle}" 
                        Content="原始" HorizontalAlignment="Left" Margin="500,103,0,0" VerticalAlignment="Top" Width="50" 
                        Click="BtnGifResize_Click"/>
                <CheckBox x:Name="checkBox_Gif_EnablePalettegen" Content="启用着色器" 
                             HorizontalAlignment="Left" Margin="485,73,0,0" 
                             VerticalAlignment="Top" Height="18" Width="110" FontSize="14"
                             >
                    <CheckBox.ToolTip>
                        <ToolTip>启用着色器可以获得更好的gif质量，但是处理时间以及文件体积会变大！</ToolTip>
                    </CheckBox.ToolTip>
                </CheckBox>
            </Grid>

            <!-- 视频加速面板 -->
            <Grid x:Name="multiplePanel" Visibility="Collapsed" Margin="0,300,0,0">
                <Label Content="倍数" HorizontalAlignment="Left" Margin="22,34,0,0" VerticalAlignment="Top" Width="127" FontSize="16"/>
                <Slider x:Name="sliderMultiple" Style="{StaticResource ModernSliderStyle}"
                    HorizontalAlignment="Left" Margin="27,73,0,0" VerticalAlignment="Top" Width="428" 
                    Minimum="0.1" Maximum="10" Value="1.5"
                    ValueChanged="SliderMultiple_ValueChanged" LargeChange="0.1"/>
                <TextBox x:Name="textBoxMultiple" HorizontalAlignment="Left" 
                    Height="20" Margin="479,72,0,0" TextWrapping="Wrap" 
                    Text="1.5" VerticalAlignment="Top" 
                    Width="44" FontSize="14" TextAlignment="Center"/>
                <Button Content="开始处理" Style="{StaticResource ModernButtonStyle}"
                    HorizontalAlignment="Left" Margin="485,195,0,0" VerticalAlignment="Top" Width="100" Height="36"
                    RenderTransformOrigin="0.12,0.579"
                    Click="BtnProcess_Click"/>
            </Grid>

            <!-- 尺寸修改面板 -->
            <Grid x:Name="resizePanel" Visibility="Collapsed" Margin="0,300,0,0">
                <Label Content="目标尺寸" HorizontalAlignment="Left" Margin="22,98,0,0" VerticalAlignment="Top" Width="73" FontSize="16"/>
                <TextBox x:Name="textBox_Size_Width" HorizontalAlignment="Left" Height="20" Margin="111,103,0,0" TextWrapping="Wrap" Text="0" VerticalAlignment="Top" Width="68" FontSize="14" TextAlignment="Center"/>
                <TextBox x:Name="textBox_Size_Height" HorizontalAlignment="Left" Height="20" Margin="198,103,0,0" TextWrapping="Wrap" Text="0" VerticalAlignment="Top" Width="67" FontSize="14" TextAlignment="Center"/>
                <Label Content="宽" HorizontalAlignment="Left" Margin="91,104,0,0" VerticalAlignment="Top" Width="24"/>
                <Label Content="高" HorizontalAlignment="Left" Margin="179,104,0,0" VerticalAlignment="Top" Width="24"/>
                <Button Tag="320" Style="{StaticResource ModernSecondaryButtonStyle}" 
                    Content="320P" HorizontalAlignment="Left" Margin="285,103,0,0" VerticalAlignment="Top" Width="40" 
                    Click="BtnSizeResize_Click"/>
                <Button Tag="480" Style="{StaticResource ModernSecondaryButtonStyle}"
                    Content="480P" HorizontalAlignment="Left" Margin="330,103,0,0" VerticalAlignment="Top" Width="40"
                    Click="BtnSizeResize_Click"/>
                <Button Tag="720" Style="{StaticResource ModernSecondaryButtonStyle}" 
                    Content="720P" HorizontalAlignment="Left" Margin="375,103,0,0" VerticalAlignment="Top" Width="40" 
                    Click="BtnSizeResize_Click"/>
                <Button Tag="1080" Style="{StaticResource ModernSecondaryButtonStyle}" 
                    Content="1080P" HorizontalAlignment="Left" Margin="420,103,0,0" VerticalAlignment="Top" Width="50" 
                    Click="BtnSizeResize_Click"/>
                <Button Tag="Orig" Style="{StaticResource ModernSecondaryButtonStyle}" 
                    Content="原始" HorizontalAlignment="Left" Margin="475,103,0,0" VerticalAlignment="Top" Width="50" 
                    Click="BtnSizeResize_Click"/>
                <Button Content="开始处理" Style="{StaticResource ModernButtonStyle}"
                    HorizontalAlignment="Left" Margin="485,195,0,0" VerticalAlignment="Top" Width="100" Height="36"
                    RenderTransformOrigin="0.12,0.579"
                    Click="BtnProcess_Click"/>
            </Grid>

            <!-- 音频提取面板 -->
            <Grid x:Name="voicePanel" Visibility="Collapsed" Margin="0,300,0,0">
                <Grid Width="200" Height="40" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="33,62,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <!-- 删除音频 -->
                    <RadioButton x:Name="radiobtnVoiceDelete"
                        Grid.Column="0"
                        Content="删除音频"
                        Style="{StaticResource ButtonRadioStyle}"/>
                    <!-- 分隔线 -->
                    <Border 
                        Grid.Column="1"
                        Width="1" 
                        Height="28" 
                        Margin="0,5,0,5" 
                        Background="#E0E0E0"/>
                    <!-- 音频提取 -->
                    <RadioButton x:Name="radiobtnVoiceExtract"
                        Grid.Column="2"
                        Content="音频提取"
                        Style="{StaticResource ButtonRadioStyle}" IsChecked="True"/>
                </Grid>
                <Button Content="开始处理" Style="{StaticResource ModernButtonStyle}"
                    HorizontalAlignment="Left" Margin="485,195,0,0" VerticalAlignment="Top" Width="100" Height="36"
                    RenderTransformOrigin="0.12,0.579"
                    Click="BtnProcess_Click"/>
            </Grid>

            <!-- 设置面板 -->
            <Grid x:Name="settingPanel" Visibility="Collapsed" Margin="0,10,0,0">
                <Label Content="ffmpeg程序路径" HorizontalAlignment="Left" Margin="19,114,0,0" VerticalAlignment="Top" Width="130" FontSize="14" FontWeight="Bold"/>
                <TextBox x:Name="textBoxSettingFmmpegPath" HorizontalAlignment="Left" Height="30" Margin="24,152,0,0" TextWrapping="Wrap" VerticalAlignment="Top" Width="328" FontSize="14"/>
                <Button Content="在线下载" Style="{StaticResource ModernSecondaryButtonStyle}" 
                        HorizontalAlignment="Left" Margin="463,152,0,0" VerticalAlignment="Top" Width="85" Height="30" 
                        Click="BtnSettingDownload_Click"/>
                <Button Content="手动选择" Style="{StaticResource ModernSecondaryButtonStyle}" 
                        HorizontalAlignment="Left" Margin="364,152,0,0" VerticalAlignment="Top" 
                        Width="85" Height="30" Click="BtnSettingChoose_Click" />
                <Label Content="视频处理功能依赖于ffmepg，请自行配置或者选择自动联网下载" HorizontalAlignment="Left" Margin="136,117,0,0" VerticalAlignment="Top" Width="371" FontSize="11"/>
                <Label x:Name="labelSettingInfo" Content="" HorizontalAlignment="Left" HorizontalContentAlignment="Center"  VerticalAlignment="Top" Margin="485,452,0,0" Width="100"/>
                <Button Content="保存" Style="{StaticResource ModernButtonStyle}" 
                        HorizontalAlignment="Left" Margin="485,482,0,0" 
                        VerticalAlignment="Top" Width="100" RenderTransformOrigin="0.12,0.579" 
                        Height="36" Click="BtnSettingSave_Click"/>
                <Label Content="视频文件输出路径" HorizontalAlignment="Left" Margin="19,191,0,0" VerticalAlignment="Top" Width="130" FontSize="14" FontWeight="Bold"/>
                <TextBox x:Name="textBoxVideoDir" HorizontalAlignment="Left" Height="30" Margin="24,224,0,0" TextWrapping="Wrap" VerticalAlignment="Top" Width="328" FontSize="14"/>
                <Button x:Name="btnSettingChooseDir" Content="选择目录" Style="{StaticResource ModernSecondaryButtonStyle}" HorizontalAlignment="Left" Margin="364,224,0,0" VerticalAlignment="Top" Width="86" Height="30" Click="BtnSettingChooseDir_Click" />
                <CheckBox x:Name="checkBox_Setting_GpuUse" 
                          Content="启用GPU加速" HorizontalAlignment="Left"
                          Margin="26,35,0,0" VerticalAlignment="Top" 
                          FontSize="16" IsChecked="True"
                          Click="CheckBoxGpu_Click">
                    <CheckBox.ToolTip>请务必确保你选择的显卡类型与你电脑匹配，否则可能会无法进行视频处理！</CheckBox.ToolTip>
                </CheckBox>
                <CheckBox x:Name="checkBox_Setting_CpuMax" 
                          Content="最大CPU利用率" HorizontalAlignment="Left" 
                          Margin="26,72,0,0" VerticalAlignment="Top" FontSize="16">
                    <CheckBox.ToolTip>勾选将使用允许的最大资源进行处理! 默认使用一半资源!</CheckBox.ToolTip>
                </CheckBox>
                <ComboBox x:Name="comboBox_Setting_GpuSelect" HorizontalAlignment="Left" Margin="169,34,0,0" 
                        VerticalAlignment="Top" Width="100" Visibility="Visible">
                    <ComboBoxItem Content="Intel"/>
                    <ComboBoxItem Content="Nvidia"/>
                    <ComboBoxItem Content="AMD"/>
                </ComboBox>
            </Grid>

        </Grid>

        <!-- 视频播放窗口 -->
        <Grid x:Name="videoPlayerFrom" Grid.Column="1" Background="#333333" Margin="0,0,0,250"
                MouseEnter="PlayerArea_MouseEnter" 
                MouseLeave="PlayerArea_MouseLeave" Grid.ColumnSpan="3" Visibility="Visible">
            <Grid.RowDefinitions>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
                <!-- 控制栏单独一行 -->
            </Grid.RowDefinitions>

            <!-- 叠加层容器 -->
            <Grid x:Name="overlayGrid" Background="#7F000000">
                <!-- 提示文字 -->
                <TextBlock x:Name="txtInstruction" 
                       Text="拖放视频文件到这里"
                       VerticalAlignment="Top"
                       HorizontalAlignment="Left"
                       Foreground="White"
                       FontSize="20"
                       Margin="175,122,0,0" Width="267" TextAlignment="Center" Height="35"/>

                <!-- 选择文件按钮 -->
                <Button x:Name="btnOpenFile"
                    Style="{StaticResource ModernSecondaryButtonStyle}"
                    VerticalAlignment="Top"
                    HorizontalAlignment="Left"
                    Margin="250,156,0,0"
                    Click="BtnOpenFile_Click"
                    Visibility="Visible" Height="32" Width="120">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock 
                            Text="&#xe632;" 
                            FontFamily="./assets/fonts/#iconfont" 
                            FontSize="16"
                            VerticalAlignment="Center"
                            Margin="2,0,3,0"/>
                        <TextBlock 
                            Text="打开视频文件" 
                            VerticalAlignment="Center"/>
                    </StackPanel>
                </Button>
            </Grid>

            <!-- 视频控件 -->
            <Viewbox Stretch="Uniform" Grid.RowSpan="2">
                <MediaElement x:Name="mediaPlayer" HorizontalAlignment="Center" Height="320" VerticalAlignment="Center" Width="560"
                            LoadedBehavior="Manual" 
                            UnloadedBehavior="Stop"
                            MediaOpened="MediaElement_MediaOpened"
                            MediaFailed="MediaElement_MediaFailed"/>
            </Viewbox>

            <!-- 控制栏 -->
            <Border x:Name="controlBar" 
                VerticalAlignment="Bottom" 
                Background="#7F000000"
                Visibility="Collapsed"
                >

                <!--MouseEnter="ControlBar_MouseEnter"
                MouseLeave="ControlBar_MouseLeave"-->

                <!--
                <Border.Style>
                    <Style TargetType="Border">
                        <Setter Property="Opacity" Value="0"/>
                        <Style.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Opacity" Value="0.9"/>
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                </Border.Style>
                -->

                <Grid Height="40">
                    <!-- 播放控制 -->
                    <StackPanel Orientation="Horizontal" 
                            VerticalAlignment="Center"
                            HorizontalAlignment="Center">

                        <!-- 播放/暂停按钮 -->
                        <Button x:Name="playPauseButton" 
                            Content="&#xe87c;" 
                            FontFamily="./assets/fonts/#iconfont" 
                            FontSize="15" 
                            Foreground="White"
                            Width="25" 
                            Height="25" 
                            Margin="2" 
                            Background="Transparent"
                            BorderBrush="Transparent"
                            FocusVisualStyle="{x:Null}"
                            Click="PlayPauseButton_Click"/>

                        <!-- 停止按钮 -->
                        <Button Content="&#xea89;" 
                            FontFamily="./assets/fonts/#iconfont"
                            FontSize="15" 
                            Foreground="White"
                            Width="25" 
                            Height="25"
                            Margin="2"
                            Background="Transparent"
                            BorderBrush="Transparent"
                            FocusVisualStyle="{x:Null}"
                            Click="StopButton_Click"/>

                        <!-- 时间显示 -->
                        <TextBlock x:Name="timeText" 
                               VerticalAlignment="Center"
                               Foreground="White"
                               Margin="10"/>

                        <!-- 进度条 -->
                        <Slider x:Name="progressSlider"
                            IsMoveToPointEnabled="True"
                            Minimum="0"
                            Width="240"
                            Margin="10"
                            VerticalAlignment="Center"
                            ValueChanged="ProgressSlider_ValueChanged"
                            PreviewMouseUp="ProgressSlider_PreviewMouseUp"
                            PreviewMouseDown="ProgressSlider_PreviewMouseDown"/>

                        <!-- 音量控制 -->
                        <Slider x:Name="volumeSlider"
                            Width="100"
                            VerticalAlignment="Center"
                            Minimum="0" 
                            Maximum="1"
                            Value="0.5"
                            TickFrequency="0.1"
                            ValueChanged="VolumeSlider_ValueChanged"/>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- 新增: 文件名显示和打开按钮的顶部栏 -->
            <Grid x:Name="topBar" VerticalAlignment="Top" Height="40" Visibility="Collapsed">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- 文件名显示 -->
                <TextBlock x:Name="txtFileName"
                    Text=""
                    Foreground="White"
                    FontSize="14"
                    Margin="10,10,0,0"
                    VerticalAlignment="Top"
                    HorizontalAlignment="Left"/>

                <!-- 右上角打开按钮 -->
                <Button x:Name="btnTopOpenFile"
                    Grid.Column="1"
                    Content="打开文件"
                    Margin="0,10,10,0"
                    Padding="10,5"
                    Background="#4CFFFFFF"
                    Foreground="White"
                    BorderBrush="Transparent"
                    Click="BtnOpenFile_Click"
                    VerticalAlignment="Top"
                    HorizontalAlignment="Right">
                    <Button.Style>
                        <Style TargetType="Button">
                            <Style.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Background" Value="#7FFFFFFF"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Style>
                </Button>
            </Grid>
        </Grid>

        <!-- 整体UI的叠加层 -->
        <Grid x:Name="ProcessingOverlay" Background="#80000000" Visibility="Collapsed" Grid.ColumnSpan="4">
            <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                <TextBlock x:Name="textBoxOverlayRunning" Text="" Foreground="White"
                           TextAlignment="Center"
                           FontSize="20" Margin="10" 
                           HorizontalAlignment="Center" VerticalAlignment="Center"/>
                <ProgressBar x:Name="progressBarOverlayRunning" 
                             Style="{StaticResource ModernProgressBarStyle}"
                             Height="16" Width="260" Visibility="Visible" Value="1"/>
                <Button x:Name="BtnCancel" Style="{StaticResource ModernDangerButtonStyle}" 
                        Content="取消" Width="100" Height="30" Margin="10"
                        Click="BtnCancel_Click"/>
            </StackPanel>
        </Grid>
    </Grid>
</Window>
